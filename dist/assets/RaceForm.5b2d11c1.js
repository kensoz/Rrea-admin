import{d as K,a as A,t as Q,s as W,n as p,p as X,o as Y,r,b as E,c as Z,f as u,u as t,e as n,y as ee,w as c,z as te,_ as g,B as y,C as oe,l as se,D as ue}from"./index.f881c86f.js";import{u as ae}from"./useFormApi.6e3171ee.js";import{u as ne}from"./useNemberApi.ac2f1870.js";import{a as le,u as ie}from"./useHooks.bcd370d1.js";import"./_commonjsHelpers.dffb1198.js";const re={class:"my-section"},ce={class:"my-contents"},me=y("\u30B2\u30B9\u30C8\u3055\u3093\u306F\u7A2E\u65CF\u30D5\u30A9\u30FC\u30E0\u306ECRUD\u304C\u3067\u304D\u307E\u305B\u3093"),pe={class:"flex flex-row justify-content-between"},de={class:"flex flex-row"},ve={class:"p-input-icon-left"},fe=n("i",{class:"pi pi-search"},null,-1),_e={class:"flex flex-row"},De=K({name:"RaceForm",setup(be){const B=A(()=>g(()=>import("./AppBreadcrumb.edc08322.js"),["assets/AppBreadcrumb.edc08322.js","assets/index.f881c86f.js","assets/index.0e688f3c.css"])),w=A(()=>g(()=>import("./AppFormDialog.9124058a.js"),["assets/AppFormDialog.9124058a.js","assets/index.f881c86f.js","assets/index.0e688f3c.css"])),V=A(()=>g(()=>import("./AppTitle.f8a25a2e.js"),["assets/AppTitle.f8a25a2e.js","assets/index.f881c86f.js","assets/index.0e688f3c.css"])),h=Q(),T=le(),{admin:d}=W(T),{formPrototype:k}=se(),{messageToast:I,missingValue:N,permissionDialog:b}=ie(),{getNemberItems:S}=ne(),{getFormItems:M,deleteFormItems:O,createFormItems:R,editFormItems:$}=ae(),F=p(),j=async()=>{await F.value.exportCSV(),I()},v=p({global:{value:void 0,matchMode:ue.CONTAINS}});let f=p(!1);const x=()=>{f.value=!1};let _=p("create"),l=p(),i=X(k);const P=async s=>{(await S("user")).findIndex(a=>a.raceCode===s.value)===-1?D(`\u300C${s.text}\u300D\u3092\u524A\u9664\u3057\u3066\u3082\u3088\u308D\u3057\u3044\u3067\u3059\u304B`,s.value):D("\u4F7F\u3063\u3066\u3044\u308B\u7A2E\u65CF\u3067\u524A\u9664\u3067\u304D\u307E\u305B\u3093")},D=(s,e)=>{h.require({message:s,header:"\u524A\u9664\u78BA\u8A8D",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-outlined p-button-warning",acceptClass:e?"":"hidden",accept:async()=>{l.value=await O("race",e)}})},L=()=>{var m;_.value="create";const s=[];(m=l.value)==null||m.map(a=>{s.push(Number(a.value))});const e=N(s);Object.assign(i,{text:"",value:e.toString()}),f.value=!0},U=s=>{_.value="edit",Object.assign(i,s),f.value=!0},q=async s=>{Object.assign(i,s),x(),l.value=_.value==="create"?await R("race",i):await $("race",i)};return Y(async()=>{l.value=await M("race")}),(s,e)=>{const m=r("Message"),a=r("Button"),z=r("InputText"),C=r("Column"),H=r("Tag"),G=r("DataTable");return E(),Z("section",re,[u(t(B),{label:[{label:"\u30D5\u30A9\u30FC\u30E0\u7BA1\u7406"},{label:"\u7A2E\u65CF"}]}),n("div",ce,[t(d).permission===2?(E(),ee(m,{key:0,severity:"error"},{default:c(()=>[me]),_:1})):te("",!0),u(t(V),{icon:"pi-users",label:"\u7A2E\u65CF\u30D5\u30A9\u30FC\u30E0\u7BA1\u7406"}),u(G,{ref_key:"csv",ref:F,filters:v.value,"onUpdate:filters":e[3]||(e[3]=o=>v.value=o),class:"p-datatable-sm",value:t(l),"data-key":"value","filter-display":"menu","global-filter-fields":["text","value"],"responsive-layout":"scroll","show-gridlines":""},{header:c(()=>[n("div",pe,[n("div",de,[u(a,{label:"\u65B0\u898F",icon:"pi pi-plus",class:"p-button-sm mr-1",onClick:e[0]||(e[0]=o=>t(d).permission===2?t(b)():L())}),u(a,{label:"CSV",icon:"pi pi-upload",class:"p-button-secondary p-button-sm",onClick:e[1]||(e[1]=o=>j())})]),n("div",null,[n("span",ve,[fe,u(z,{modelValue:v.value.global.value,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value.global.value=o),class:"p-inputtext-sm max-w-10rem md:max-w-max",placeholder:"\u691C\u7D22"},null,8,["modelValue"])])])])]),footer:c(()=>{var o;return[y(" \u30C8\u30FC\u30BF\u30EB\u30A2\u30A4\u30C6\u30E0\uFF1A"+oe((o=t(l))==null?void 0:o.length),1)]}),default:c(()=>[u(C,{header:"\u7DE8\u96C6\u30FB\u524A\u9664"},{body:c(o=>[n("div",_e,[u(a,{icon:"pi pi-pencil",class:"p-button-outlined p-button-sm p-button-info mr-2",onClick:J=>t(d).permission===2?t(b)():U(o.data)},null,8,["onClick"]),u(a,{icon:"pi pi-trash",class:"p-button-outlined p-button-sm p-button-danger",onClick:J=>t(d).permission===2?t(b)():P(o.data)},null,8,["onClick"])])]),_:1}),u(C,{field:"text",header:"\u7A2E\u65CF",sortable:!0},{body:c(o=>[u(H,{value:o.data.text},null,8,["value"])]),_:1}),u(C,{field:"value",header:"\u30F4\u30A1\u30EA\u30E5\u30FC",sortable:!0})]),_:1},8,["filters","value"])]),u(t(w),{visible:t(f),mode:t(_),form:t(i),onColse:e[4]||(e[4]=o=>x()),onConfirm:q},null,8,["visible","mode","form"])])}}});export{De as default};
