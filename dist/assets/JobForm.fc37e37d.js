import{d as K,a as g,t as Q,s as W,n as p,p as X,o as Y,r,b as y,c as Z,f as u,u as t,e as n,y as ee,w as c,z as te,_ as D,B,C as oe,l as se,D as ue}from"./index.b9160266.js";import{u as ae}from"./useFormApi.4f9fd1b3.js";import{u as ne}from"./useNemberApi.d11dba3c.js";import{a as le,u as ie}from"./useHooks.2cd27d9b.js";import"./_commonjsHelpers.dffb1198.js";const re={class:"my-section"},ce={class:"my-contents"},me=B("\u30B2\u30B9\u30C8\u3055\u3093\u306F\u8077\u52D9\u30D5\u30A9\u30FC\u30E0\u306ECRUD\u304C\u3067\u304D\u307E\u305B\u3093"),pe={class:"flex flex-row justify-content-between"},de={class:"flex flex-row"},ve={class:"p-input-icon-left"},fe=n("i",{class:"pi pi-search"},null,-1),be={class:"flex flex-row"},Fe=K({name:"JobForm",setup(_e){const E=g(()=>D(()=>import("./AppBreadcrumb.29322dc6.js"),["assets/AppBreadcrumb.29322dc6.js","assets/index.b9160266.js","assets/index.a8fa6635.css"])),w=g(()=>D(()=>import("./AppFormDialog.4623c5e1.js"),["assets/AppFormDialog.4623c5e1.js","assets/index.b9160266.js","assets/index.a8fa6635.css"])),V=g(()=>D(()=>import("./AppTitle.c1e24e6a.js"),["assets/AppTitle.c1e24e6a.js","assets/index.b9160266.js","assets/index.a8fa6635.css"])),h=Q(),T=le(),{admin:d}=W(T),{formPrototype:k}=se(),{messageToast:I,missingValue:N,permissionDialog:_}=ie(),{getNemberItems:j}=ne(),{getFormItems:S,deleteFormItems:M,createFormItems:O,editFormItems:$}=ae(),A=p(),R=async()=>{await A.value.exportCSV(),I()},v=p({global:{value:void 0,matchMode:ue.CONTAINS}});let f=p(!1);const x=()=>{f.value=!1};let b=p("create"),l=X(k),i=p();const P=async s=>{(await j("user")).findIndex(a=>a.jobCode===s.value)===-1?F(`\u300C${s.text}\u300D\u3092\u524A\u9664\u3057\u3066\u3082\u3088\u308D\u3057\u3044\u3067\u3059\u304B`,s.value):F("\u4F7F\u3063\u3066\u3044\u308B\u8077\u52D9\u3067\u524A\u9664\u3067\u304D\u307E\u305B\u3093")},F=(s,e)=>{h.require({message:s,header:"\u524A\u9664\u78BA\u8A8D",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-outlined p-button-warning",acceptClass:e?"":"hidden",accept:async()=>{i.value=await M("job",e)}})},L=()=>{var m;b.value="create";const s=[];(m=i.value)==null||m.map(a=>{s.push(Number(a.value))});const e=N(s);Object.assign(l,{text:"",value:e.toString()}),f.value=!0},U=s=>{b.value="edit",Object.assign(l,s),f.value=!0},q=async s=>{Object.assign(l,s),x(),i.value=b.value==="create"?await O("job",l):await $("job",l)};return Y(async()=>{i.value=await S("job")}),(s,e)=>{const m=r("Message"),a=r("Button"),z=r("InputText"),C=r("Column"),H=r("Tag"),J=r("DataTable");return y(),Z("section",re,[u(t(E),{label:[{label:"\u30D5\u30A9\u30FC\u30E0\u7BA1\u7406"},{label:"\u8077\u52D9"}]}),n("div",ce,[t(d).permission===2?(y(),ee(m,{key:0,severity:"error"},{default:c(()=>[me]),_:1})):te("",!0),u(t(V),{icon:"pi-briefcase",label:"\u8077\u52D9\u30D5\u30A9\u30FC\u30E0\u7BA1\u7406"}),u(J,{ref_key:"csv",ref:A,filters:v.value,"onUpdate:filters":e[3]||(e[3]=o=>v.value=o),class:"p-datatable-sm",value:t(i),"data-key":"value","filter-display":"menu","global-filter-fields":["text","value"],"responsive-layout":"scroll","show-gridlines":""},{header:c(()=>[n("div",pe,[n("div",de,[u(a,{label:"\u65B0\u898F",icon:"pi pi-plus",class:"p-button-sm mr-1",onClick:e[0]||(e[0]=o=>t(d).permission===2?t(_)():L())}),u(a,{label:"CSV",icon:"pi pi-upload",class:"p-button-secondary p-button-sm",onClick:e[1]||(e[1]=o=>R())})]),n("div",null,[n("span",ve,[fe,u(z,{modelValue:v.value.global.value,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value.global.value=o),class:"p-inputtext-sm max-w-10rem md:max-w-full",placeholder:"\u691C\u7D22"},null,8,["modelValue"])])])])]),footer:c(()=>{var o;return[B(" \u30C8\u30FC\u30BF\u30EB\u30A2\u30A4\u30C6\u30E0\uFF1A"+oe((o=t(i))==null?void 0:o.length),1)]}),default:c(()=>[u(C,{header:"\u7DE8\u96C6\u30FB\u524A\u9664"},{body:c(o=>[n("div",be,[u(a,{icon:"pi pi-pencil",class:"p-button-outlined p-button-sm p-button-info mr-2",onClick:G=>t(d).permission===2?t(_)():U(o.data)},null,8,["onClick"]),u(a,{icon:"pi pi-trash",class:"p-button-outlined p-button-sm p-button-danger",onClick:G=>t(d).permission===2?t(_)():P(o.data)},null,8,["onClick"])])]),_:1}),u(C,{field:"text",header:"\u8077\u52D9",sortable:!0},{body:c(o=>[u(H,{value:o.data.text},null,8,["value"])]),_:1}),u(C,{field:"value",header:"\u30F4\u30A1\u30EA\u30E5\u30FC",sortable:!0})]),_:1},8,["filters","value"])]),u(t(w),{visible:t(f),mode:t(b),form:t(l),onColse:e[4]||(e[4]=o=>x()),onConfirm:q},null,8,["visible","mode","form"])])}}});export{Fe as default};
